<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
"http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="library.mapper.BookMapper">
	<resultMap id="BookResult" type="library.dto.BookDto">
        <result column="book_id" property="bookId" />
        <result column="book_kanaByte" property="bookKanaByte" />
        <result column="book_name" property="bookName" />
        <result column="author_kanaByte" property="authorKanaByte" />
        <result column="author_name" property="authorName" />
        <result column="rental_time" property="rentalTime" />
        <result column="shelf_id" property="shelfId" />
        <result column="document_id" property="documentId" />
        <result column="library_id" property="libraryId" />
    </resultMap>
    <resultMap id="LibraryResult" type="library.dto.LibraryDto">
        <result column="library_id" property="libraryId" />
        <result column="library_name" property="libraryName" />
    </resultMap>
	<insert id="insert">
		INSERT INTO book (book_kanaByte, book_name, author_kanaByte, author_name, publisher
		 , isbn, shelf_id, document_id, library_id, status_id) 
		 VALUES (#{bookKanaByte}, #{bookName}, #{authorKanaByte}, #{authorName}
		 , #{publisher}, #{isbn}, #{shelfId}, #{documentId}, #{libraryId}, '1') ;
	</insert>

	<select id="library" resultMap="LibraryResult">
		SELECT * FROM library ; 
	</select>
	<insert id="rental">
		INSERT INTO rental (user_id, isbn, library_id, rental_time)
		 VALUES (#{userId}, #{isbn}, #{libraryId}, #{rentalTime}) ;
	</insert>
	<delete id="returnBook">
		DELETE FROM rental WHERE isbn = #{isbn} AND library_id = #{libraryId};
	</delete>
</mapper>